---
title: 51-基于-分发层-应用层双层nginx架构提升缓存命中率方案分析
date: 2018-12-26 18:45:43
tags:
categories: mysql
---


## 缓存命中率低

部署多个nginx，在里面都会放一些缓存，就默认情况下，此时缓存命中率是比较低的。

## 如何提升缓存命中率

分发层 + 应用层，双层nginx

1. 分发层
分发层nginx，负责流量分发的逻辑和策略，这个里面它可以根据你自己定义的一些规则，比如根据productId去进行hash，然后对后端的nginx数量取模。

将某一个商品的访问的请求，就固定路由到一个nginx后端服务器上去，保证说只会从redis中获取一次缓存数据，后面全都是走nginx本地缓存了。

1. 应用层
后端的nginx服务器，就称之为应用服务器; 最前端的nginx服务器，被称之为分发服务器。

看似很简单，其实很有用，在实际的生产环境中，可以大幅度提升你的nginx本地缓存这一层的命中率，大幅度减少redis后端的压力，提升性能。

![缓存命中率低的原因](缓存命中率低的原因.png)

![分发层-应用层双层nginx架构](分发层-应用层双层nginx架构.png)


